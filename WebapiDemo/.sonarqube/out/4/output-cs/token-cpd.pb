¥V
=E:\CX\WebapiDemo\WebapiDemo\Controllers\LoginApiController.cs
	namespace 	

WebapiDemo
 
. 
Controllers  
{ 
[		 
ApiController		 
]		 
[ 
Route 

(
 
$str 
) 
] 
[ 

EnableCors 
( 
$str 
) 
] 
public 

class 
LoginApiController #
:$ %
ControllerBase& 4
{ 
private 
readonly 
IUserBll !
userBll" )
;) *
public 
LoginApiController !
(! "
IUserBll" *
userBll+ 2
)2 3
{ 	
this 
. 
userBll 
= 
userBll "
;" #
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
List 
< 

UserBModel 
? 
>  
?  !
DebugGetAll" -
(- .
). /
{ 	
return 
userBll 
. 
DebugGetAllUsers +
(+ ,
), -
;- .
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 

UserBModel 
? 
DebugGetById '
(' (
int( +
id, .
). /
{   	
return!! 
userBll!! 
.!! 
DebugGetUserById!! +
(!!+ ,
id!!, .
)!!. /
;!!/ 0
}"" 	
[%% 	
HttpGet%%	 
(%% 
$str%% 
)%% 
]%% 
public&& 

UserBModel&& 
?&& 
GetById&& "
(&&" #
int&&# &
id&&' )
)&&) *
{'' 	
return(( 
userBll(( 
.(( 
GetUserById(( &
(((& '
id((' )
)(() *
;((* +
})) 	
[,, 	
HttpGet,,	 
(,, 
$str,,  
),,  !
],,! "
public-- 
string-- 
GetUserNameById-- %
(--% &
int--& )
id--* ,
)--, -
{.. 	
return// 
userBll// 
.// 
GetUserNameById// *
(//* +
id//+ -
)//- .
;//. /
}00 	
[33 	
HttpGet33	 
(33 
$str33  
)33  !
]33! "
public44  
UserBaseInfoResponse44 #
?44# $
GetBaseInfoById44% 4
(444 5
int445 8
id449 ;
)44; <
{55 	
return66 
userBll66 
.66 
GetUserBaseInfoById66 .
(66. /
id66/ 1
)661 2
?662 3
.663 4
ToBaseResponse664 B
(66B C
)66C D
;66D E
}77 	
[:: 	
HttpGet::	 
(:: 
$str:: 
):: 
]:: 
public;; 
UserInfoResponse;; 
?;;  
GetInfoById;;! ,
(;;, -
int;;- 0
id;;1 3
);;3 4
{<< 	
return== 
userBll== 
.== !
GetUserDetailInfoById== 0
(==0 1
id==1 3
)==3 4
?==4 5
.==5 6

ToResponse==6 @
(==@ A
)==A B
;==B C
}>> 	
[AA 	
HttpPostAA	 
(AA 
$strAA 
)AA 
]AA 
publicBB 
IActionResultBB 

CheckLoginBB '
(BB' (
[BB( )
FromBodyBB) 1
]BB1 2
LoginRequestBB3 ?
requestBB@ G
)BBG H
{CC 	
intDD 
userIdDD 
;DD 
ifFF 
(FF 
!FF 
stringFF 
.FF 
IsNullOrEmptyFF %
(FF% &
requestFF& -
.FF- .
AutoLoginTokenFF. <
)FF< =
)FF= >
{GG 
userIdHH 
=HH 
userBllHH  
.HH  !
CheckAutoLoginTokenHH! 4
(HH4 5
requestHH5 <
.HH< =
AutoLoginTokenHH= K
)HHK L
;HHL M
ifII 
(II 
userIdII 
==II 
-II 
$numII  
)II  !
{JJ 
returnKK 

BadRequestKK %
(KK% &
$strKK& /
)KK/ 0
;KK0 1
}LL 
ResponseNN 
.NN 
HeadersNN  
.NN  !
AddNN! $
(NN$ %
$strNN% D
,NND E
$strNNF N
)NNN O
;NNO P
ResponseOO 
.OO 
HeadersOO  
.OO  !
AddOO! $
(OO$ %
$strOO% -
,OO- .
userIdOO/ 5
.OO5 6
ToStringOO6 >
(OO> ?
)OO? @
)OO@ A
;OOA B
returnQQ 
OkQQ 
(QQ 
$strQQ #
)QQ# $
;QQ$ %
}RR 
ifTT 
(TT 
stringTT 
.TT 
IsNullOrEmptyTT $
(TT$ %
requestTT% ,
.TT, -
UserNameTT- 5
)TT5 6
||TT7 9
stringTT: @
.TT@ A
IsNullOrEmptyTTA N
(TTN O
requestTTO V
.TTV W
PasswordTTW _
)TT_ `
)TT` a
{UU 
returnVV 

BadRequestVV !
(VV! "
$strVV" ,
)VV, -
;VV- .
}WW 
userIdYY 
=YY 
userBllYY 
.YY 

CheckLoginYY '
(YY' (
requestYY( /
.YY/ 0
UserNameYY0 8
,YY8 9
requestYY: A
.YYA B
PasswordYYB J
)YYJ K
;YYK L
ifZZ 
(ZZ 
userIdZZ 
==ZZ 
-ZZ 
$numZZ 
)ZZ 
{[[ 
return\\ 

BadRequest\\ !
(\\! "
$str\\" ,
)\\, -
;\\- .
}]] 
if__ 
(__ 
!__ 
request__ 
.__ 

RememberMe__ #
)__# $
{`` 
Responseaa 
.aa 
Headersaa  
.aa  !
Addaa! $
(aa$ %
$straa% D
,aaD E
$straaF N
)aaN O
;aaO P
Responsebb 
.bb 
Headersbb  
.bb  !
Addbb! $
(bb$ %
$strbb% -
,bb- .
userIdbb/ 5
.bb5 6
ToStringbb6 >
(bb> ?
)bb? @
)bb@ A
;bbA B
returncc 
Okcc 
(cc 
$strcc !
)cc! "
;cc" #
}dd 
elseee 
{ff 
stringgg 
tokengg 
=gg 
userBllgg &
.gg& '"
GenerateAutoLoginTokengg' =
(gg= >
userIdgg> D
)ggD E
;ggE F
ifhh 
(hh 
stringhh 
.hh 
IsNullOrEmptyhh (
(hh( )
tokenhh) .
)hh. /
)hh/ 0
{ii 
returnjj 

BadRequestjj %
(jj% &
$strjj& 1
)jj1 2
;jj2 3
}kk 
Responsemm 
.mm 
Headersmm  
.mm  !
Addmm! $
(mm$ %
$strmm% D
,mmD E
$strmmF ]
)mm] ^
;mm^ _
Responsenn 
.nn 
Headersnn  
.nn  !
Addnn! $
(nn$ %
$strnn% -
,nn- .
userIdnn/ 5
.nn5 6
ToStringnn6 >
(nn> ?
)nn? @
)nn@ A
;nnA B
Responseoo 
.oo 
Headersoo  
.oo  !
Addoo! $
(oo$ %
$stroo% 5
,oo5 6
tokenoo7 <
)oo< =
;oo= >
returnqq 
Okqq 
(qq 
$strqq *
)qq* +
;qq+ ,
}rr 
}ss 	
[vv 	
HttpPostvv	 
]vv 
publicww 
IActionResultww 
Insertww #
(ww# $
[ww$ %
FromBodyww% -
]ww- .
UserInsertRequestww/ @
requestwwA H
)wwH I
{xx 	
ifzz 
(zz 
userBllzz 
.zz 
CheckUserExistzz &
(zz& '
requestzz' .
.zz. /
UserNamezz/ 7
)zz7 8
)zz8 9
{{{ 
return|| 

BadRequest|| !
(||! "
$str||" +
)||+ ,
;||, -
}}} 
int 
userId 
= 
userBll  
.  !
AddUser! (
(( )
request) 0
.0 1
ToBModel1 9
(9 :
): ;
); <
;< =
if
ÄÄ 
(
ÄÄ 
userId
ÄÄ 
==
ÄÄ 
-
ÄÄ 
$num
ÄÄ 
)
ÄÄ 
{
ÅÅ 
return
ÇÇ 

BadRequest
ÇÇ !
(
ÇÇ! "
$str
ÇÇ" )
)
ÇÇ) *
;
ÇÇ* +
}
ÉÉ 
else
ÑÑ 
{
ÖÖ 
Response
ÜÜ 
.
ÜÜ 
Headers
ÜÜ  
.
ÜÜ  !
Add
ÜÜ! $
(
ÜÜ$ %
$str
ÜÜ% D
,
ÜÜD E
$str
ÜÜF N
)
ÜÜN O
;
ÜÜO P
Response
áá 
.
áá 
Headers
áá  
.
áá  !
Add
áá! $
(
áá$ %
$str
áá% -
,
áá- .
userId
áá/ 5
.
áá5 6
ToString
áá6 >
(
áá> ?
)
áá? @
)
áá@ A
;
ááA B
return
àà 
Ok
àà 
(
àà 
$str
àà !
)
àà! "
;
àà" #
}
ââ 
}
ää 	
[
çç 	
HttpPut
çç	 
]
çç 
public
éé 
string
éé 
Update
éé 
(
éé 
[
éé 
FromBody
éé &
]
éé& '
UserUpdateRequest
éé( 9
request
éé: A
)
ééA B
{
èè 	
return
êê 
userBll
êê 
.
êê 

UpdateUser
êê %
(
êê% &
request
êê& -
.
êê- .
ToBModel
êê. 6
(
êê6 7
)
êê7 8
)
êê8 9
;
êê9 :
}
ëë 	
[
îî 	

HttpDelete
îî	 
(
îî 
$str
îî 
)
îî 
]
îî 
public
ïï 
string
ïï 
Remove
ïï 
(
ïï 
int
ïï  
id
ïï! #
)
ïï# $
{
ññ 	
return
óó 
userBll
óó 
.
óó 

RemoveUser
óó %
(
óó% &
id
óó& (
)
óó( )
;
óó) *
}
òò 	
}
ôô 
}öö âN
<E:\CX\WebapiDemo\WebapiDemo\Controllers\PostApiController.cs
	namespace 	

WebapiDemo
 
. 
Controllers  
{		 
[

 
ApiController

 
]

 
[ 
Route 

(
 
$str 
) 
] 
[ 

EnableCors 
( 
$str 
) 
] 
public 

class 
PostApiController "
:# $
ControllerBase% 3
{ 
private 
readonly 
IPostBll !
postBll" )
;) *
public 
PostApiController  
(  !
IPostBll! )
postBll* 1
)1 2
{ 	
this 
. 
postBll 
= 
postBll "
;" #
} 	
[ 	
HttpGet	 
( 
$str &
)& '
]' (
public 
List 
< 
Post 
? 
> 
? 

GetAllPost &
(& '
int' *
	sectionId+ 4
)4 5
{ 	
return 
postBll 
. 
GetAllPosts &
(& '
	sectionId' 0
)0 1
;1 2
} 	
[ 	
HttpGet	 
( 
$str +
)+ ,
], -
public 
List 
< 
Post 
? 
> 
? 
GetPosts $
($ %
int% (
	sectionId) 2
,2 3
int4 7

mainPostId8 B
)B C
{ 	
return 
postBll 
. 
GetPosts #
(# $
	sectionId$ -
,- .

mainPostId/ 9
)9 :
;: ;
}   	
["" 	
HttpGet""	 
("" 
$str"" &
)""& '
]""' (
public## 
List## 
<##  
UserBaseInfoResponse## (
?##( )
>##) *
?##* +

GetAllUser##, 6
(##6 7
int##7 :
	sectionId##; D
)##D E
{$$ 	
List%% 
<%% 

UserBModel%% 
?%% 
>%% 
?%% 
user%% #
=%%$ %
postBll%%& -
.%%- .
GetAllUsers%%. 9
(%%9 :
	sectionId%%: C
)%%C D
;%%D E
if&& 
(&& 
user&& 
==&& 
null&& 
)&& 
{'' 
return(( 
null(( 
;(( 
})) 
List++ 
<++  
UserBaseInfoResponse++ %
?++% &
>++& '
?++' (
result++) /
=++0 1
new++2 5
(++5 6
)++6 7
;++7 8
foreach,, 
(,, 

UserBModel,, 
?,,  
u,,! "
in,,# %
user,,& *
),,* +
{-- 
if.. 
(.. 
u.. 
==.. 
null.. 
).. 
{// 
continue00 
;00 
}11 
result22 
.22 
Add22 
(22 
new33  
UserBaseInfoResponse33 ,
{44 
Id55 
=55 
u55 
.55 
Id55 !
,55! "
UserName66  
=66! "
u66# $
.66$ %
UserName66% -
??66. 0
$str661 :
,66: ;
RegisterTime77 $
=77% &
u77' (
.77( )
RegisterTime77) 5
.775 6
ToString776 >
(77> ?
$str77? K
)77K L
,77L M
Points88 
=88  
u88! "
.88" #
Points88# )
}99 
):: 
;:: 
};; 
return== 
result== 
;== 
}>> 	
[@@ 	
HttpGet@@	 
(@@ 
$str@@ #
)@@# $
]@@$ %
publicAA 
ListAA 
<AA 
PostAA 
?AA 
>AA 
?AA 
GetPostsAA $
(AA$ %
intAA% (
	sectionIdAA) 2
,AA2 3
[AA4 5
FromBodyAA5 =
]AA= >!
PostGetInRangeRequestAA? T
requestAAU \
)AA\ ]
{BB 	
returnCC 
postBllCC 
.CC 
GetPostsCC #
(CC# $
newDD 
PostListBModelDD "
{EE 
	SectionIdFF 
=FF 
	sectionIdFF  )
,FF) *
BeginNumGG 
=GG 
requestGG &
.GG& '
BeginNumGG' /
,GG/ 0
NeedNumHH 
=HH 
requestHH %
.HH% &
NeedNumHH& -
}II 
)JJ 
;JJ 
}KK 	
[MM 	
HttpGetMM	 
(MM 
$strMM #
)MM# $
]MM$ %
publicNN 
ListNN 
<NN  
UserBaseInfoResponseNN (
?NN( )
>NN) *
?NN* +
GetUsersNN, 4
(NN4 5
intOO 
	sectionIdOO 
,OO 
[PP 
FromBodyPP 
]PP !
PostGetInRangeRequestPP ,
requestPP- 4
)QQ 	
{RR 	
ListSS 
<SS 

UserBModelSS 
?SS 
>SS 
?SS 
userSS #
=SS$ %
postBllSS& -
.SS- .
GetUsersSS. 6
(SS6 7
newTT 
PostListBModelTT "
{UU 
	SectionIdVV 
=VV 
	sectionIdVV  )
,VV) *
BeginNumWW 
=WW 
requestWW &
.WW& '
BeginNumWW' /
,WW/ 0
NeedNumXX 
=XX 
requestXX %
.XX% &
NeedNumXX& -
}YY 
)ZZ 
;ZZ 
if\\ 
(\\ 
user\\ 
==\\ 
null\\ 
)\\ 
{]] 
return^^ 
null^^ 
;^^ 
}__ 
Listaa 
<aa  
UserBaseInfoResponseaa %
?aa% &
>aa& '
?aa' (
resultaa) /
=aa0 1
newaa2 5
(aa5 6
)aa6 7
;aa7 8
foreachbb 
(bb 

UserBModelbb 
?bb  
ubb! "
inbb# %
userbb& *
)bb* +
{cc 
ifdd 
(dd 
udd 
==dd 
nulldd 
)dd 
{ee 
continueff 
;ff 
}gg 
resulthh 
.hh 
Addhh 
(hh 
newii  
UserBaseInfoResponseii ,
{jj 
Idkk 
=kk 
ukk 
.kk 
Idkk !
,kk! "
UserNamell  
=ll! "
ull# $
.ll$ %
UserNamell% -
??ll. 0
$strll1 :
,ll: ;
RegisterTimemm $
=mm% &
umm' (
.mm( )
RegisterTimemm) 5
.mm5 6
ToStringmm6 >
(mm> ?
$strmm? K
)mmK L
,mmL M
Pointsnn 
=nn  
unn! "
.nn" #
Pointsnn# )
}oo 
)pp 
;pp 
}qq 
returnss 
resultss 
;ss 
}tt 	
[vv 	
HttpPostvv	 
(vv 
$strvv 
)vv  
]vv  !
publicww 
intww 
Insertww 
(ww 
intww 
	sectionIdww '
,ww' (
[ww) *
FromBodyww* 2
]ww2 3
PostInsertRequestww4 E
requestwwF M
)wwM N
{xx 	
returnyy 
postBllyy 
.yy 
AddPostyy "
(yy" #
	sectionIdyy# ,
,yy, -
requestyy. 5
.yy5 6
ToPostyy6 <
(yy< =
)yy= >
)yy> ?
;yy? @
}zz 	
[}} 	
HttpPut}}	 
(}} 
$str}} '
)}}' (
]}}( )
public~~ 
string~~ 
Update~~ 
(~~ 
int~~  
	sectionId~~! *
,~~* +
int~~, /
postId~~0 6
,~~6 7
[~~8 9
FromBody~~9 A
]~~A B
PostUpdateRequest~~C T
request~~U \
)~~\ ]
{ 	
if
ÄÄ 
(
ÄÄ 
request
ÄÄ 
.
ÄÄ 
UpVote
ÄÄ 
)
ÄÄ 
{
ÅÅ 
postBll
ÇÇ 
.
ÇÇ 
UpVote
ÇÇ 
(
ÇÇ 
	sectionId
ÇÇ (
,
ÇÇ( )
postId
ÇÇ* 0
)
ÇÇ0 1
;
ÇÇ1 2
return
ÉÉ 
$str
ÉÉ 
;
ÉÉ 
}
ÑÑ 
else
ÖÖ 
if
ÖÖ 
(
ÖÖ 
request
ÖÖ 
.
ÖÖ 
DownVote
ÖÖ %
)
ÖÖ% &
{
ÜÜ 
postBll
áá 
.
áá 
DownVote
áá  
(
áá  !
	sectionId
áá! *
,
áá* +
postId
áá, 2
)
áá2 3
;
áá3 4
return
àà 
$str
àà 
;
àà 
}
ââ 
return
ãã 
$str
ãã 
;
ãã 
}
åå 	
[
èè 	
HttpPut
èè	 
(
èè 
$str
èè ,
)
èè, -
]
èè- .
public
êê 
void
êê 

UpdateView
êê 
(
êê 
int
êê "
	sectionId
êê# ,
,
êê, -
int
êê. 1
postId
êê2 8
)
êê8 9
{
ëë 	
postBll
íí 
.
íí 

UpdateView
íí 
(
íí 
	sectionId
íí (
,
íí( )
postId
íí* 0
)
íí0 1
;
íí1 2
}
ìì 	
}
îî 
}ïï Ï*
?E:\CX\WebapiDemo\WebapiDemo\Controllers\SectionApiController.cs
	namespace		 	

WebapiDemo		
 
.		 
Controllers		  
{

 
[ 
ApiController 
] 
[ 
Route 

(
 
$str 
) 
] 
[ 

EnableCors 
( 
$str 
) 
] 
public 

class  
SectionApiController %
:& '
ControllerBase( 6
{ 
private 
readonly 
ISectionBll $

sectionBll% /
;/ 0
private 
readonly 
IUserBll !
userBll" )
;) *
private 
readonly 
IPostBll !
postBll" )
;) *
public  
SectionApiController #
(# $
ISectionBll$ /

sectionBll0 :
,: ;
IUserBll< D
userBllE L
,L M
IPostBllN V
postBllW ^
)^ _
{ 	
this 
. 

sectionBll 
= 

sectionBll (
;( )
this 
. 
userBll 
= 
userBll "
;" #
this 
. 
postBll 
= 
postBll "
;" #
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
List 
< 
Section 
> 
? 
GetAll $
($ %
)% &
{ 	
return 

sectionBll 
. 
GetAllSections ,
(, -
)- .
;. /
}   	
[## 	
HttpGet##	 
(## 
$str## 
)## 
]## 
public$$ 
Section$$ 
?$$ 
GetById$$ 
($$  
int$$  #
id$$$ &
)$$& '
{%% 	
return&& 

sectionBll&& 
.&& 
GetSectionById&& ,
(&&, -
id&&- /
)&&/ 0
;&&0 1
}'' 	
[** 	
HttpGet**	 
(** 
$str** (
)**( )
]**) *
public++ 
List++ 
<++ 
Post++ 
>++ 
?++ 
GetMainPosts++ '
(++' (
int++( +
	sectionId++, 5
)++5 6
{,, 	
return-- 

sectionBll-- 
.-- 
GetMainPosts-- *
(--* +
	sectionId--+ 4
)--4 5
;--5 6
}.. 	
[11 	
HttpPost11	 
(11 
$str11 -
)11- .
]11. /
public22 
List22 
<22 !
LastReplyInfoResponse22 )
>22) *
?22* +
GetLastReplyInfo22, <
(22< =
int22= @
	sectionId22A J
,22J K
[22K L
FromBody22L T
]22T U
List22V Z
<22Z [
int22[ ^
>22^ _
mainPostIds22` k
)22k l
{33 	
List55 
<55 
Post55 
>55 
lastReplyPosts55 %
=55& '
new55( +
(55+ ,
)55, -
;55- .
foreach66 
(66 
int66 

mainPostId66 #
in66$ &
mainPostIds66' 2
)662 3
{77 
Post88 
?88 
lastReplyPost88 #
=88$ %
postBll88& -
.88- .
GetLastReplyPosts88. ?
(88? @
	sectionId88@ I
,88I J

mainPostId88K U
)88U V
;88V W
if99 
(99 
lastReplyPost99 !
!=99" $
null99% )
)99) *
{:: 
lastReplyPosts;; "
.;;" #
Add;;# &
(;;& '
lastReplyPost;;' 4
);;4 5
;;;5 6
}<< 
}== 
List?? 
<?? !
LastReplyInfoResponse?? &
>??& '"
lastReplyInfoResponses??( >
=??? @
new??A D
(??D E
)??E F
;??F G
for@@ 
(@@ 
int@@ 
i@@ 
=@@ 
$num@@ 
;@@ 
i@@ 
<@@ 
lastReplyPosts@@  .
.@@. /
Count@@/ 4
;@@4 5
i@@6 7
++@@7 9
)@@9 :
{AA "
lastReplyInfoResponsesCC &
.CC& '
AddCC' *
(CC* +
newCC+ .!
LastReplyInfoResponseCC/ D
{DD 

MainPostIdEE 
=EE  
lastReplyPostsEE! /
[EE/ 0
iEE0 1
]EE1 2
.EE2 3

MainPostIdEE3 =
,EE= >
UsernameFF 
=FF 
userBllFF &
.FF& '
GetUserNameByIdFF' 6
(FF6 7
lastReplyPostsFF7 E
[FFE F
iFFF G
]FFG H
.FFH I
UserIdFFI O
)FFO P
,FFP Q
	ReplyTimeGG 
=GG 
lastReplyPostsGG  .
[GG. /
iGG/ 0
]GG0 1
.GG1 2
PublishTimeGG2 =
}HH 
)HH 
;HH 
}II 
returnKK "
lastReplyInfoResponsesKK )
;KK) *
}LL 	
}MM 
}NN Ú	
;E:\CX\WebapiDemo\WebapiDemo\Controllers\ValuesController.cs
	namespace 	

WebapiDemo
 
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class 
ValuesController !
:" #
ControllerBase$ 2
{		 
[

 	
HttpGet

	 
]

 
public 
string 
GetA 
( 
string !
name" &
,& '
string( .
	helloWord/ 8
)8 9
{ 	
if 
( 
string 
. 
IsNullOrEmpty #
(# $
name$ (
)( )
||* ,
string- 3
.3 4
IsNullOrEmpty4 A
(A B
	helloWordB K
)K L
)L M
{ 
return 
$str %
;% &
} 
return 
$" 
{ 
	helloWord 
}  
$str  !
{! "
name" &
}& '
$str' (
"( )
;) *
} 	
} 
} ˚
;E:\CX\WebapiDemo\WebapiDemo\Models\LastReplyInfoResponse.cs
	namespace 	

WebapiDemo
 
. 
Models 
{ 
public 

class !
LastReplyInfoResponse &
{ 
public 
int 

MainPostId 
{ 
get  #
;# $
set% (
;( )
}* +
public 
required 
string 
Username '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public

 
DateTime

 
	ReplyTime

 !
{

" #
get

$ '
;

' (
set

) ,
;

, -
}

. /
} 
} †
2E:\CX\WebapiDemo\WebapiDemo\Models\LoginRequest.cs
	namespace 	

WebapiDemo
 
. 
Models 
{ 
public 

class 
LoginRequest 
{		 
public

 
string

 
?

 
UserName

 
{

  !
get

" %
;

% &
set

' *
;

* +
}

, -
public 
string 
? 
Password 
{  !
get" %
;% &
set' *
;* +
}, -
public 
bool 

RememberMe 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
? 
AutoLoginToken %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
} 
} ¿
;E:\CX\WebapiDemo\WebapiDemo\Models\PostGetInRangeRequest.cs
	namespace 	

WebapiDemo
 
. 
Models 
{ 
public 

class !
PostGetInRangeRequest &
{ 
public 
int 
BeginNum 
{ 
get !
;! "
set# &
;& '
}( )
public 
int 
NeedNum 
{ 
get  
;  !
set" %
;% &
}' (
} 
} Ç
7E:\CX\WebapiDemo\WebapiDemo\Models\PostInsertRequest.cs
	namespace 	

WebapiDemo
 
. 
Models 
{ 
public 

class 
PostInsertRequest "
{ 
public 
int 
UserId 
{ 
get 
;  
set! $
;$ %
}& '
public		 
required		 
string		 
Content		 &
{		' (
get		) ,
;		, -
set		. 1
;		1 2
}		3 4
public

 
int

 

MainPostId

 
{

 
get

  #
;

# $
set

% (
;

( )
}

* +
public 
bool 

IsMainPost 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
? 
Type 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
? 
Title 
{ 
get "
;" #
set$ '
;' (
}) *
public 
int 
ViewNum 
{ 
get  
;  !
set" %
;% &
}' (
public 
int 
ReplyNum 
{ 
get !
;! "
set# &
;& '
}( )
} 
public 

static 
class 
PostVToBMapper &
{ 
public 
static 
Post 
ToPost !
(! "
this" &
PostInsertRequest' 8
request9 @
)@ A
{ 	
return 
new 
Post 
{ 
UserId 
= 
request  
.  !
UserId! '
,' (
Content 
= 
request !
.! "
Content" )
,) *

MainPostId 
= 
request $
.$ %

MainPostId% /
,/ 0

IsMainPost 
= 
request $
.$ %

IsMainPost% /
,/ 0
Type 
= 
request 
. 
Type #
,# $
Title 
= 
request 
.  
Title  %
,% &
ViewNum 
= 
request !
.! "
ViewNum" )
,) *
ReplyNum 
= 
request "
." #
ReplyNum# +
}   
;   
}!! 	
}"" 
}## π
7E:\CX\WebapiDemo\WebapiDemo\Models\PostUpdateRequest.cs
	namespace 	

WebapiDemo
 
. 
Models 
{ 
public 

class 
PostUpdateRequest "
{ 
public 
bool 
UpVote 
{ 
get  
;  !
set" %
;% &
}' (
public 
bool 
DownVote 
{ 
get "
;" #
set$ '
;' (
}) *
}		 
}

 Ã
:E:\CX\WebapiDemo\WebapiDemo\Models\UserBaseInfoResponse.cs
	namespace 	

WebapiDemo
 
. 
Models 
{ 
public 

class  
UserBaseInfoResponse %
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
required 
string 
UserName '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
required 
string 
RegisterTime +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
public 
int 
Points 
{ 
get 
;  
set! $
;$ %
}& '
} 
public 

static 
class .
"UserBToVUserBaseInfoResponseMapper :
{ 
public 
static  
UserBaseInfoResponse *
ToBaseResponse+ 9
(9 :
this: >

UserBModel? I
userBaseInfoBModelJ \
)\ ]
{ 	
return 
new  
UserBaseInfoResponse +
{ 
Id 
= 
userBaseInfoBModel '
.' (
Id( *
,* +
UserName 
= 
userBaseInfoBModel -
.- .
UserName. 6
??6 8
$str9 B
,B C
RegisterTime 
= 
userBaseInfoBModel 1
.1 2
RegisterTime2 >
.> ?
ToString? G
(G H
$strH T
)T U
,U V
Points 
= 
userBaseInfoBModel +
.+ ,
Points, 2
} 
; 
} 	
} 
} ◊
6E:\CX\WebapiDemo\WebapiDemo\Models\UserInfoResponse.cs
	namespace 	

WebapiDemo
 
. 
Models 
{ 
public 

class 
UserInfoResponse !
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
required 
string 
UserName '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public

 
required

 
string

 
NickName

 '
{

( )
get

* -
;

- .
set

/ 2
;

2 3
}

4 5
public 
required 
string 
Gender %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
required 
string 
	Signature (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
required 
string 
Avatar %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
required 
string 
RegisterTime +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
public 
required 
string 
LastLoginTime ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
public 
int 
	UserLevel 
{ 
get "
;" #
set$ '
;' (
}) *
public 
int 
Points 
{ 
get 
;  
set! $
;$ %
}& '
} 
public 

static 
class *
UserBToVUserInfoResponseMapper 6
{7 8
public 
static 
UserInfoResponse &

ToResponse' 1
(1 2
this2 6

UserBModel7 A
userInfoBModelB P
)P Q
{ 	
return 
new 
UserInfoResponse '
{ 
Id   
=   
userInfoBModel   #
.  # $
Id  $ &
,  & '
UserName!! 
=!! 
userInfoBModel!! )
.!!) *
UserName!!* 2
??!!2 4
$str!!5 >
,!!> ?
NickName"" 
="" 
userInfoBModel"" )
."") *
NickName""* 2
??""2 4
$str""5 =
,""= >
Gender## 
=## 
userInfoBModel## '
.##' (
Gender##( .
??##. 0
$str##1 9
,##9 :
	Signature$$ 
=$$ 
userInfoBModel$$ *
.$$* +
	Signature$$+ 4
??$$4 6
$str$$7 ?
,$$? @
Avatar%% 
=%% 
userInfoBModel%% '
.%%' (
Avatar%%( .
??%%. 0
$str%%1 9
,%%9 :
RegisterTime&& 
=&& 
userInfoBModel&& -
.&&- .
RegisterTime&&. :
.&&: ;
ToString&&; C
(&&C D
$str&&D P
)&&P Q
,&&Q R
LastLoginTime'' 
='' 
userInfoBModel''  .
.''. /
LastLoginTime''/ <
.''< =
ToString''= E
(''E F
$str''F R
)''R S
,''S T
	UserLevel(( 
=(( 
userInfoBModel(( *
.((* +
	UserLevel((+ 4
,((4 5
Points)) 
=)) 
userInfoBModel)) '
.))' (
Points))( .
}** 
;** 
}++ 	
},, 
}-- –
7E:\CX\WebapiDemo\WebapiDemo\Models\UserInsertRequest.cs
	namespace 	

WebapiDemo
 
. 
Models 
{ 
public		 

class		 
UserInsertRequest		 "
{

 
public 
required 
string 
UserName '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
required 
string 
Password '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
string 
? 
NickName 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
? 
Gender 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
? 
	Signature  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
? 
Avatar 
{ 
get  #
;# $
set% (
;( )
}* +
} 
public 

static 
class  
UserInsertVToBMapper ,
{ 
public 
static 

UserBModel  
ToBModel! )
() *
this* .
UserInsertRequest/ @
requestA H
)H I
{ 	
return 
new 

UserBModel !
{ 
UserName 
= 
request "
." #
UserName# +
,+ ,
Password 
= 
request "
." #
Password# +
,+ ,
NickName 
= 
request "
." #
NickName# +
,+ ,
Gender 
= 
request  
.  !
Gender! '
,' (
	Signature 
= 
request #
.# $
	Signature$ -
,- .
Avatar 
= 
request  
.  !
Avatar! '
} 
; 
}   	
}!! 
}"" ¥
7E:\CX\WebapiDemo\WebapiDemo\Models\UserUpdateRequest.cs
	namespace 	

WebapiDemo
 
. 
Models 
{ 
public		 

class		 
UserUpdateRequest		 "
{

 
public 
required 
int 
Id 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
? 
Password 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
? 
NickName 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
? 
Gender 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
? 
	Signature  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
? 
Avatar 
{ 
get  #
;# $
set% (
;( )
}* +
} 
public 

static 
class  
UserUpdateVToBMapper ,
{ 
public 
static 

UserBModel  
ToBModel! )
() *
this* .
UserUpdateRequest/ @
requestA H
)H I
{ 	
return 
new 

UserBModel !
{ 
Id 
= 
request 
. 
Id 
,  
Password 
= 
request "
." #
Password# +
,+ ,
NickName 
= 
request "
." #
NickName# +
,+ ,
Gender 
= 
request  
.  !
Gender! '
,' (
	Signature 
= 
request #
.# $
	Signature$ -
,- .
Avatar 
= 
request  
.  !
Avatar! '
} 
; 
}   	
}!! 
}"" B
@E:\CX\WebapiDemo\WebapiDemo\Models\Web4UserInsertRequest copy.cs=
;E:\CX\WebapiDemo\WebapiDemo\Models\Web4UserUpdateRequest.csÜ
&E:\CX\WebapiDemo\WebapiDemo\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
builder

 
.

 
Services

 
.

 #
AddEndpointsApiExplorer

 (
(

( )
)

) *
;

* +
builder 
. 
Services 
. 
AddSwaggerGen 
( 
)  
;  !
builder 
. 
Services 
. 
AddControllers 
(  
)  !
;! "
builder 
. 
Services 
. 
AddSingleton 
< 
IUserBll &
,& '
UserBll( /
>/ 0
(0 1
)1 2
;2 3
builder 
. 
Services 
. 
AddSingleton 
< 
IPostDalFactory -
,- .
PostDalFactory/ =
>= >
(> ?
)? @
;@ A
builder 
. 
Services 
. 
AddSingleton 
< 
IPostBll &
,& '
PostBll( /
>/ 0
(0 1
)1 2
;2 3
builder 
. 
Services 
. 
AddSingleton 
< 
ISectionBll )
,) *

SectionBll+ 5
>5 6
(6 7
)7 8
;8 9
builder 
. 
Services 
. 
AddCors 
( 
c 
=> 
{ 
c 
. 
	AddPolicy 
( 
$str 
, 
p 
=> 
{ 
p 	
.	 

AllowAnyMethod
 
( 
) 
. 
AllowAnyOrigin )
() *
)* +
.+ ,
AllowAnyHeader, :
(: ;
); <
;< =
} 
) 
; 
} 
) 
; 
var 
app 
= 	
builder
 
. 
Build 
( 
) 
; 
if   
(   
app   
.   
Environment   
.   
IsDevelopment   !
(  ! "
)  " #
)  # $
{!! 
app"" 
."" 

UseSwagger"" 
("" 
)"" 
;"" 
app## 
.## 
UseSwaggerUI## 
(## 
)## 
;## 
}$$ 
app&& 
.&& 
MapControllers&& 
(&& 
)&& 
;&& 
app'' 
.'' 
UseHttpsRedirection'' 
('' 
)'' 
;'' 
app(( 
.(( 
UseCors(( 
((( 
$str(( 
)(( 
;(( 
app)) 
.)) 
Run)) 
()) 
))) 	
;))	 
